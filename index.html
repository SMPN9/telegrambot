<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BotTelegram</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="kertasF4.css"><script src="jsxls1.js"></script><script src="jsxls2.js"></script>
 <style>
#b2,#b1,#b14,#b15{border:none;background:green;color:white;font-size:20px;padding:5px;border-radius:5px;margin:5px}
#b13,#b133, #b133{border:none;background:green;color:white;font-size:20px;padding:5px 70px;border-radius:5px;margin:5px}
#token{border:none;font-size:20px;padding:5px;border-radius:5px;margin:5px;width:600px;}
#b2:hover{ background:orange;cursor:pointer}
#b1:hover{ background:orange;}
#b14:hover{ background:orange;cursor:pointer}
#b13:hover{ background:orange;cursor:pointer}
#b133:hover{ background:orange;cursor:pointer}
#b15:hover{ background:orange;cursor:pointer}
Table tr.header, Table tr:hover {
  background-color: #f1f1f1;
}
 th{padding:10px;background:black;color:white}
table{ white-space:;text-overflow:ellipsis;
  border-collapse: collapse;
  padding:3px;
  border: 1px solid #ddd;
  font-size: 14px;
  border-radius:3px;box-shadow:0px 1px 10px 0px rgb(0,0,0,0.3);
 }
table tr {
 border: 1px solid #ddd;
 }
table td:nth-child(1) {  font-weight:bold;text-align:center;
 }
 table th:nth-child(1) { border-top-left-radius:5px;
 }
 table th:nth-child(4) { border-top-right-radius:5px;
</style>    
</head>
<body>	
<style>
		.page {
			padding: 0.7cm;
		}

		td {
			padding: 0px 0px 3px 3px;
		}
	#tb1 {border:1px solid red margin:0}
	#b13,#b133{display:none}
	</style>    
  <center>
<button  id="b2" onclick="ddw()"><i class="fa fa-download" style="font-size:20px"></i>  Download Telegrambot.xlsx</button><br/>
<input type="text" id="token" placeholder="Masukkan Token Bot di sini"  /><button id="b15" onclick="gosimp()"><i class="fa fa-check-square-o" style="font-size:20px"></i>   Simpan Token </button><br/>
<input type="file"  style='display:none' onchange="Upload()" id="fileUpload" />
 <button id="b14" onclick="file.click()"><i class="fa fa-file-excel-o" style="font-size:20px"></i> Cari File </button><br/>
<button id="b13" onclick="stop=1;gotele();this.style.display='none'"><i class="fa fa-toggle-right" style="font-size:20px"></i>   Start Bot</button><br/>
<button id="b133" onclick="stop=0;this.style.display='none'"><i class="fa fa-spinner fa-spin" style="font-size:20px"></i> Stop Bot</button><br/>
<table id='tb' border='1'><tr><th style="background:green;text-align:left;font-size:20px" colspan="4"><i class="fa fa-vcard-o" style="font-size:20px"></i> Chat Masuk</th></tr><tr><th>N0</th><th>ID</th><th>PESAN</th><th>ID FOTO</th></tr></table><p/><br/>
<table id='tbs' border='1'><tr><th style="background:green;text-align:left;font-size:20px" colspan="4"><i class="fa fa-newspaper-o" style="font-size:20px"></i>  Data Excel</th></tr><tr><th>NIS</th><th>NAMA</th><th>TGL_LAHIR</th><th>ID_FOTO</th></tr></table><p/><br/>
</center>
    <script>
	var isitbl='';
	var mytoken='';
	var comb='';
	var foto;
    var stop=0
	var fxl='data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,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'
    var cek1=document.getElementById("b1");
	var file=document.getElementById("fileUpload");
	var gt=document.getElementById("b14"); 
	var tbb=document.getElementById('tb')
	var tbbs=document.getElementById('tbs')
	var b13=document.getElementById('b13')
	var excelRows;
	var hit=1;
	if(localStorage.getItem("token"))
	{ document.getElementById('token').value=localStorage.getItem("token");mytoken="https://api.telegram.org/bot"+localStorage.getItem("token") }   
    if(localStorage.getItem("dataxls"))
	{excelRows=JSON.parse(localStorage.getItem("dataxls")); b13.style.display="block"; 
	  for ( var i=0;i<excelRows.length;i++){ 
	       var rows = tbbs.insertRow(-1)
	      rows.insertCell(0).innerHTML=excelRows[i].NIS;rows.insertCell(1).innerHTML=excelRows[i].NAMA;rows.insertCell(2).innerHTML=excelRows[i].TGL_LAHIR;
		 if(excelRows[i].ID_FOTO == undefined){rows.insertCell(3).innerHTML=""} else {
		rows.insertCell(3).innerHTML=excelRows[i].ID_FOTO;} 
	}
	}
	function Upload() {
        var fileUpload = document.getElementById("fileUpload");
        var regex = /^([a-zA-Z0-9\s_\\.\-:])+(.xls|.xlsx)$/;
		 
        if (regex) {
            if (typeof (FileReader) != "undefined") {
                var reader = new FileReader();          
                if (reader.readAsBinaryString) {
                    reader.onload = function (e) {
					    gt.innerHTML="File : "+fileUpload.files[0].name;
                        ProcessExcel(e.target.result);
                    };
                    reader.readAsBinaryString(fileUpload.files[0]);
                } else {
                    
                    reader.onload = function (e) {
                        var data = "";
                        var bytes = new Uint8Array(e.target.result);
                        for (var i = 0; i < bytes.byteLength; i++) {
                            data += String.fromCharCode(bytes[i]);
                        }
                         ProcessExcel(data);
                    };
                    reader.readAsArrayBuffer(fileUpload.files[0]);
                }
            } else {
                alert("browser anda tidak support  HTML5");
            }
        } else {
            alert("maaf, silahkan upload file excel yg valid");
        }
    };
    function ProcessExcel(data) {
        var workbook = XLSX.read(data, {
            type: 'binary'
        });
        var firstSheet = workbook.SheetNames[0];
         excelRows = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[firstSheet]);		 
        b13.style.display="block";
		   tbbs.innerHTML=' <tr><th style="background:green;text-align:left" colspan="4">Data Excel</th></tr><tr><th>NIS</th><th>NAMA</th><th>TGL_LAHIR</th><th>ID_FOTO</th></tr>';
		for ( var i=0;i<excelRows.length;i++){ 
	       var rows = tbbs.insertRow(-1)
	      rows.insertCell(0).innerHTML=excelRows[i].NIS;rows.insertCell(1).innerHTML=excelRows[i].NAMA;rows.insertCell(2).innerHTML=excelRows[i].TGL_LAHIR;
		 if(excelRows[i].ID_FOTO == undefined){rows.insertCell(3).innerHTML=""} else {
		rows.insertCell(3).innerHTML=excelRows[i].ID_FOTO;} 
	}
	       setTimeout(function(){
		  var mm=confirm("Simpan data di browser  ...?");
		  if (mm==true){goupdate()}  },200)
	}
function ddw(){
    const a = document.createElement('a');
    a.style.display = 'none';
    a.href = fxl;
    a.download ='TelegramBot.xlsx'
    document.body.appendChild(a);
    a.click();
	a.text='downloading...';
    a.remove();
}	
 var upid=0;
function gotele(){
if(stop==1){ b133.style.display="block" }
const xhttp = new XMLHttpRequest();
xhttp.onload = function() 
{
const data=JSON.parse(xhttp.responseText);
var ids;
var pess;
for ( var k=0;k<data.result.length;k++){ 

if (data.result[k].callback_query){
var pes="Id.Telegram Anda: "+data.result[k].callback_query.from.id+"%0ANama: "+data.result[k].callback_query.from.first_name+"%0AUser Name :"+data.result[k].callback_query.from.username;
sendtele(data.result[k].callback_query.id,pes,3,333);upid=data.result[k].update_id+1;

setTimeout(function(){  if(stop==1){ gotele();} else {b13.style.display="block"}  },1000);

return}
   
var row = tbb.insertRow(-1)
	row.insertCell(0).innerHTML=hit;
	row.insertCell(1).innerHTML=data.result[k].message.chat.id
	ids=data.result[k].message.chat.id;
	if (data.result[k].message.text){row.insertCell(2).innerHTML=data.result[k].message.text;pess=data.result[k].message.text;gocek(ids,pess,data.result[k].message.from.first_name);} else { 
	  if (data.result[k].message.caption){ row.insertCell(2).innerHTML=data.result[k].message.caption;pess=data.result[k].message.caption} else{
	pess='tdk ada caption'
	row.insertCell(2).innerHTML=''}
	}
	 if (data.result[k].message.photo){row.insertCell(3).innerHTML=data.result[k].message.photo[1].file_id } else { row.insertCell(3).innerHTML=''}
     hit++;
upid=data.result[k].update_id+1;
}

setTimeout(function(){  if(stop==1){ gotele();} else {b13.style.display="block"}  },1000)
}
xhttp.onerror=function(e){alert("tidak ada koneksi internet");b13.style.display="block";b133.style.display="none";stop=0}
xhttp.open("GET", mytoken+"/getUpdates?timeout=10&offset="+upid); 
xhttp.send();
}
function sendtele(id,pesan,kode,idpt){
var kirim=''
if (kode==0){kirim=mytoken+"/sendMessage?chat_id="+id+"&text="+pesan+"&parse_mode=markdown"}
else {
  if (kode==3){kirim=mytoken+"/answerCallbackQuery?callback_query_id="+id+"&text="+pesan+"&show_alert=true&parse_mode=markdown"} 
  else{
    if (kode==4){kirim=mytoken+"/sendMessage?chat_id="+id+"&text="+pesan+"&reply_markup="+start()+"&parse_mode=markdown" ;
	     
		}
	else {
	 
	 if (kode==5){kirim=mytoken+"/sendMessage?chat_id="+id+"&text="+pesan+"&reply_markup="+start1()+"&parse_mode=markdown" ;}
	else {
kirim=mytoken+"/sendPhoto?chat_id="+id+"&photo="+idpt+"&caption="+pesan+"&parse_mode=markdown"}}}
}

const xhttp = new XMLHttpRequest();
xhttp.onload = function() 
{   
const data=JSON.parse(xhttp.responseText);  
}
xhttp.onerror=function(e){}
xhttp.open("POST",kirim)
xhttp.send()
}
function gocek(id,pesan,nama){
  var bb=0;
  if (pesan.toUpperCase()=="/START" || pesan.toUpperCase()=="MULAI KEMBALI"){ pesan="Selamat Datang *"+nama+"* ID.Kamu *"+id+"*" ;sendtele(id,pesan,4,0);
  
  pesan="Untuk cek NIS, Silahkam masukkan NIS Anda !";sendtele(id,pesan,5,0)
  
  ;return  }
	for ( var i=0;i<excelRows.length;i++){ 
	
	      if( excelRows[i].NIS==pesan){
		   bb=1;
		   pesan="*NIS : *"+excelRows[i].NIS+"%0A"+"*NAMA : *"+excelRows[i].NAMA+"%0A"+"*TGL LAHIR : *"+excelRows[i].TGL_LAHIR.toString();
		    if(excelRows[i].ID_FOTO==undefined){ sendtele(id,pesan,0,0)}
			else { sendtele(id,pesan,1,excelRows[i].ID_FOTO)}
		 }  
	}
    if (bb==0){pesan="Maaf NIS : *"+pesan+"* tidak ditemukan";sendtele(id,pesan,0,0)}
}
 function gosimp(){
 var dgg=document.getElementById('token').value;
 mytoken="https://api.telegram.org/bot"+dgg;
if (dgg == ""){
 alert("Token tidak boleh kosong")}
 else{localStorage.setItem('token',dgg)
  alert("Token berhasil disimpan")}
 }
function goupdate(){
localStorage.setItem('dataxls',JSON.stringify(excelRows))  
}
function start() {
  var keyboard ={
    "inline_keyboard": [

[{"text": "INFO ID","callback_data": 1}]]
   }
    return JSON.stringify(keyboard)
}
function start1(){
 var keyboard ={
    keyboard: [
      [ 
       "MULAI KEMBALI",
      ]
    ]
     ,
      "resize_keyboard":true
  } 
 return JSON.stringify(keyboard)
}
 

  </script></body>
</html>